'use client'

import { createContext, useContext, useState, ReactNode } from 'react'

type NavigationSection = 
  | 'dashboard' 
  | 'forms-list' 
  | 'forms-create' 
  | 'analytics' 
  | 'settings'
  | 'settings-profile'
  | 'settings-notifications'
  | 'settings-appearance'
  | 'settings-security'
  | 'settings-integrations'
  | 'settings-danger'

interface NavigationContextType {
  currentSection: NavigationSection
  setCurrentSection: (section: NavigationSection) => void
  title: string
  setTitle: (title: string) => void
}

const NavigationContext = createContext<NavigationContextType | undefined>(undefined)

interface NavigationProviderProps {
  children: ReactNode
}

export function NavigationProvider({ children }: NavigationProviderProps) {
  const [currentSection, setCurrentSection] = useState<NavigationSection>('dashboard')
  const [title, setTitle] = useState('Dashboard')

  const updateSection = (section: NavigationSection) => {
    console.log('üîÑ NavigationContext: Mudando se√ß√£o de', currentSection, 'para', section)
    setCurrentSection(section)
    
    // Atualizar t√≠tulo baseado na se√ß√£o
    const titles = {
      'dashboard': 'Dashboard',
      'forms-list': 'Formul√°rios',
      'forms-create': 'Criar Formul√°rio',
      'analytics': 'Analytics',
      'settings': 'Configura√ß√µes',
      'settings-profile': 'Perfil',
      'settings-notifications': 'Notifica√ß√µes',
      'settings-appearance': 'Apar√™ncia',
      'settings-security': 'Seguran√ßa',
      'settings-integrations': 'Integra√ß√µes',
      'settings-danger': 'Zona de Perigo'
    }
    
    const newTitle = titles[section]
    console.log('üìù NavigationContext: Atualizando t√≠tulo para', newTitle)
    setTitle(newTitle)
  }

  return (
    <NavigationContext.Provider 
      value={{ 
        currentSection, 
        setCurrentSection: updateSection,
        title,
        setTitle
      }}
    >
      {children}
    </NavigationContext.Provider>
  )
}

export function useNavigation() {
  const context = useContext(NavigationContext)
  if (context === undefined) {
    throw new Error('useNavigation must be used within a NavigationProvider')
  }
  return context
}
